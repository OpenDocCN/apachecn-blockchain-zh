# 在Oracle区块链平台上管理解决方案

前一章涵盖了业务场景，并允许我们探索 **Oracle区块链平台** ( **OBP** )。使用OBP管理解决方案轻而易举；它允许你去做实验，而不是阅读关于做的东西，因为它有效地用例子演示了做的过程。这一章提供了关于OBP的深入事实，让你在毕业时掌握OBP的实用知识。通过本章，您将了解到将网络拓扑转换到OBP、创建网络利益相关者和配置OBP实例的实用性。该知识分类帐说明了如何设置交易基础设施、将参与者加入业务网络、访问控制、将智能(链码)添加到业务网络，以及使用REST代理配置将链码暴露给dApps。在很大程度上，OBP SDK和Oracle云上的OBP在功能上是相似的，除了让您创建OBP实例的步骤。这两个选项之间的差异并不大，也是不言自明的。本章主要讲述在OBP上转换网络拓扑，为OBP网络增加业务智能，以及使用管理REST界面。

# 将网络拓扑转换到OBP

本节介绍如何在OBP上创建网络实例。如[第四章](4.html)、*在区块链平台*从事商业案例*设计解决方案*部分所述，区块链网络需要以下商业实体:

*   **甲骨文帝国大学** ( **OEU** )作为创始人实体
*   **甲骨文红学** ( **ORS** )和**证书查看者** / **验证者** ( **CVs** )作为参与实体

# 用OBP实例创建网络利益相关者

构建OBP解决方案的基础步骤包括为涉众实体创建OBP实例。执行以下步骤，为用例创建必要的OBP实例:

1.  启动并登录OBP预配控制台。参见[第四章](4.html)、*在区块链平台*上做业务案例*搭建OBP SDK* 部分，了解OBP置备控制台详情。
2.  登录后，通过填写实例详细信息开始创建OBP实例。
3.  下面的屏幕截图显示了创建实例的示例值。请注意以下两点:
    *   只能为创建者实例选择创建者复选框。
    *   为起始端口提供不同OBP实例的值。确保这些端口值相距较远，因为OBP在内部为起始端口连续分配多个值，如以下屏幕截图所示:

![](assets/4bb4a2d8-af0a-4189-827b-f7eb6709a5ed.png)

创建实例

4.  一旦我们用例的所有OBP实例被创建(并激活)，它们将显示在配置控制台上，如下面的屏幕截图所示:

![](assets/c62e1d9e-b8b3-49b1-a81d-7c879b19a298.png)

创建者和参与者实例摘要

5.  单击每个OBP实例的上下文菜单，并选择控制台URL以导航到相应实例的OBP仪表板。我们用例的OBP网络创建的后续步骤是通过OBP仪表板完成的:

![](assets/61b43cee-b7d7-44b7-a637-94ee008ca756.png)

OBP实例的上下文菜单

由于 **oeu** 是创始人组织，它将拥有比其他参与者OBP实例更多的OBP系统组件。另外， **oeu** 作为创始人组织，是一个自给自足的组织，所以它在仪表板上也有不同的可视化元素。一旦我们完成了参与者实例的网络设置，我们也将在仪表板上获得类似的可视化效果。

下表给出了OBP工件下的默认值:

| **OBP神器** | **创始人** ( **OEU** ) | **参与者** ( **ORS或CVs** ) |
| 引导 | one | 0 |
| 凝视 | 2 | 2 |
| 订购者 | one | 0 |
| 加利福尼亚 | one | one |
| REST代理 | 2 | 2 |

下面的屏幕截图显示了 **oeu** 仪表板，这是创始人组织(oeu)的仪表板:

![](assets/1d579638-4954-4df4-9c5c-990171ccfc1c.png)

OBP方正仪表板

看一看**或**仪表盘。ors和cvs仪表盘外观相似:

![](assets/56bef2e1-8b74-42ec-abeb-c6d02733bd42.png)

OBP参与者仪表板

# 配置OBP网络基础设施

创建OBP实例后，构建OBP解决方案的下一步是在这些实例之间建立区块链事务网络。本节将向您介绍连接网络中所有OBP例程并启用基础共享分类帐基础结构的步骤。

以下部分列出了这些步骤。

# 导出/导入参与者证书

导出参与者( **ors** 和 **cvs** )组织/实例证书，导入到创始人OBP实例中。步骤如下:

1.  导出参与组织证书
2.  将参与组织证书导入创建者组织

第一步是导出参与组织证书。您可以通过以下两种方式之一导出参与者的OBP实例证书:

*   **选项1** :使用仪表板向导，如下截图所示:

![](assets/d7250a5b-6843-4200-a549-756c081e500a.png)

OBP参与者出口证明流程

*   **选项2** :从OBP仪表板网络选项卡下的组织上下文菜单中为参与者( **ors** 和 **cvs** ):

![](assets/a1446219-2545-46a9-921e-e156bc32678e.png)

OBP参与者网络摘要

参与者证书是一个JSON文件，它包含admin、 **c** **认证机构** ( **CA** )和**传输层安全性** ( **TLS** )的证书密钥及其签名。下面的屏幕截图展示了其中一个参与者证书:

![](assets/8fbb2efa-1d61-40f6-80df-eab90c62aa45.png)

OBP参与者证书快照

第二步是将参与组织证书导入创建组织。按照以下步骤将参与者证书导入创始人组织:

1.  转到founder dashboard (oeu)以导入这些参与者的证书。这可以通过选择oeu页面上网络选项卡下的添加组织选项来实现。下面的屏幕截图描述了这些步骤。
2.  通过导入ors和cv的参与者证书来添加组织:

![](assets/565ebed0-5e91-41c1-b6de-22649db57b59.png)

导入参与者证书

创建者的“网络”选项卡允许我们导入参与者证书:

![](assets/a2ab671f-6a71-4718-9388-de704d13b39b.png)

方正网络总结

# 订购者配置

建立OBP网络的下一步是将订购者配置从创始人导入参与者。

由于订购者与基础结构级别的创建者实例相关联，因此执行这种设置就变得势在必行。它确保由参与对等体提交的任何区块链提议(交易)在最终被写入共享分类帐之前，由同一订购者进行确认以及分类帐块的订购。

以下步骤提供了如何完成订购者配置设置的逐步说明:

1.  使用网络选项卡下的**导出订购者设置**选项，导出方正实例的订购者设置:

![](assets/97a9dc0b-3afd-4943-979e-b392326876e3.png)

导出的有序设置

从技术上讲，OBP的订购者设置也以JSON文件的形式表示和存储，并包含创建者证书、签名和订购者端点。您还将为订购者获得一个类似的JSON文件，如下面的屏幕截图所示:

![](assets/c5606234-8adc-4f07-a03c-5bb883fa7842.png)

有序设置的json文件

2.  将订购者设置导入到每个参与者(ors和cv)中，如下面几个屏幕截图所示。
3.  单击ors仪表板网络选项卡下的订购者设置导入选项:

![](assets/cc00ff84-0da6-498c-97da-6f06c3a3c615.png)

有序设置json文件

4.  上传从oeu导出的订购文件

![](assets/d3087c10-ce50-4334-a465-1fcac50113b7.png)

将有序设置导入参与者

5.  订购者设置导入完成后，您可以选择订购者设置视图选项来验证订购者详细信息。请注意，以下订购者地址实例与从founder导出的订购者设置JSON文件中的订购者端点相同:

![](assets/b3111596-52c3-4635-b065-f2536e03814a.png)

匹配有序设置

# 配置OBP交易基础设施

在设置了基本的OBP网络基础设施之后，如前一节所述，现在是时候设置OBP交易基础设施了。主要是在系统配置中定义共享分类帐，并关联可以读取/写入分类帐的交易方(OBP例程)。

对于我们的用例，这将涉及与OEU(创始人)建立一个通道，并将ORS、CVs和OBP实例添加到同一个通道中。详见[第四章](4.html)、*在区块链平台上从事商业案例*的*网络拓扑*和*渠道*章节。

顾名思义，信道是OBP中的逻辑或配置结构，它允许两个或更多的网络利益相关者共享数据。这种数据共享是通过共享分类账完成的。因此，OBP的每个渠道本质上也代表了与之相关的基础共享分类账。

# 频道设置

让我们继续为用例创建必要的渠道:

1.  转到oeu仪表板的渠道选项卡，然后单击创建新渠道。
2.  更新以下字段:
    *   频道名称:提供频道的名称。请记下它，因为你在打电话时会用到它。
    *   选择ors和cvs实例的复选框。
    *   选择 **oeu** 的一个或多个同行加入渠道，如以下截图所示:

![](assets/f2595ba9-8fc4-4edf-8185-6a106e18bb54.png)

创建频道

一旦通道创建成功，您可以在oeu仪表板上看到相应的通知，新创建的通道将显示在现有的**通道**列表中。 **oeu** Channels选项卡将类似于下面的屏幕截图:

![](assets/4e30b7d0-e90a-408d-8750-1f0febe5da25.png)

创建渠道摘要

# 将参与者对等体加入通道

在使用OEU的OBP实例创建了一个通道之后，将参与者ORS和CVS的对等节点添加到同一个通道中。通过这样做，我们可以确保该通道的各个OBP实例的应用程序客户端提交的任何事务都将被对等节点接受，并添加到通道中进行验证、链代码执行和RWSet创建。然后，该RWSet将提交给订购方，用于分类账块的排序。

您可以通过以下任一选项将参与者的对等方添加到通道:

*   使用“参与者OBP”控制板的“节点”选项卡下的对等节点的上下文菜单，如以下屏幕截图所示:

![](assets/02f2c198-240b-471c-9423-9ddf18dfe76d.png)

节点摘要

*   使用参与者OBP控制板的“渠道”选项卡下的渠道上下文菜单，如以下屏幕截图所示:

![](assets/b3b51e57-3324-4bed-bba6-6736db6f7834.png)

频道摘要

继续选项2，您将被要求选择**对等方加入渠道**选项。您可以选择实例的一个或多个对等方加入:

![](assets/08dfb2aa-03f6-436b-b387-330d7f533439.png)

加入渠道

一旦参与对等体加入通道，OBP实例节点的拓扑视图应该如下面几节中的屏幕截图所示。

# 创建者节点摘要

以下屏幕截图显示了创建者组织的节点摘要:

![](assets/e9e3ea38-20d4-4c6c-83db-92e4f119ade4.png)

创建者节点摘要

# 参与者(ors)节点摘要

以下屏幕截图显示了ors组织的节点摘要:

![](assets/bf684277-c276-4dd5-90b3-4d63403049e4.png)

参与者节点摘要

# 参与者(cvs)节点摘要

以下屏幕截图显示了另一个参与者(cvs)组织的节点摘要:

![](assets/30c35059-127d-4466-b5b7-ef2f4d7d0f8a.png)

参与者节点摘要

此外，验证OEU、ORS和CVs的网络拓扑视图是否显示了以下屏幕截图所示的可视化效果。

# 方正网络总结

以下截图显示了创始人组织(oeu)的网络概要:

![](assets/3c347e6f-5e4f-4105-83d9-339c25fc165d.png)

方正网络总结

# 参与者(ors)网络总结

以下屏幕截图显示了其中一个参与组织的网络摘要:

![](assets/26c09a3b-87f8-4e9a-8d49-ca7ad6de285c.png)

参与者(ors)网络总结

# 参与者(cvs)网络摘要

以下屏幕截图显示了其他参与组织(cvs)的网络概要:

![](assets/26356d2e-dc02-433d-9b34-760450aa84d4.png)

参与者(cvs)网络摘要

# 为OBP网络增添智慧

接下来的章节详细介绍了通过链码开发为OBP网络增加商业智能，以及向客户端应用程序公开链码功能。下面的部分提供了它的预览。

# 开发链码，为OBP网络增添智慧

完成配置OBP网络的步骤后，下一组实施包括增加网络的智能性。通常，这意味着添加我们的用例业务逻辑作为智能契约或链码。它处理链码在网络实例的所有节点上的安装和实例化。

本书的下一章涵盖了我们用例的链码和相关网络工件的实现。 [第六章](6.html)，*在甲骨文区块链平台*上开发解决方案，涵盖了用例所需的链码的开发、部署和实例化。关于网络构件设计的更多细节，请参见[第四章](4.html)的*网络构件*部分，*在Blockchai*n平台上从事业务案例。

# 通过REST代理配置公开链代码

这些配置通常包括向客户端应用程序(如dApp)公开链码功能的定义。出于顺序连续性的考虑，REST代理配置的详细信息请参见[第六章](6.html)、*在Oracle区块链平台上开发解决方案*的chaincode部署部分。

# OBP的REST接口

设置和管理OBP网络的所有管理和配置步骤(如前所述)也可以使用OBP的Administration REST服务来执行。这些服务适用于需要以下内容的情况:

*   减少这些活动的手动模式
*   实施自动化方式(如DevOps管道)来设置和管理OBP网络
*   以定制的方式表示OBP管理信息

这些管理REST接口包括与组织、节点、通道和链代码相关的服务。此外，OBP还提供OBP统计休息捆绑服务。

以下是OBP政府休息服务的列表:

*   组织REST端点:在组织REST端点下，以下是服务列表:
    *   获取组织证书
    *   获取组织管理员凭据
    *   获取创始人组织中的订购服务设置
    *   加入一个新组织到一个创始组织
    *   为参与组织设置订购服务
*   节点REST端点:在节点REST端点下，以下是服务列表:
    *   获取节点列表
    *   获取频道上的对等点列表
    *   获取特定链代码的对等点列表
    *   添加对等节点
    *   启动/停止对等节点
    *   移除对等节点
    *   获取/设置对等节点的属性
    *   将对等机加入频道
    *   导出/导入对等项
    *   开始/停止订购
    *   获取/设置订购者的属性
    *   启动/停止CA节点
    *   获取/设置CA的属性
    *   开始/停止休息代理
    *   获取/设置REST代理的配置

*   通道REST端点:在通道REST端点下，以下是服务列表:
    *   创建一个频道
    *   获取频道列表
    *   获取chaincode的频道列表
    *   获取对等点的频道列表
    *   更新频道配置
    *   获取频道信息
    *   按块ID获取分类帐块
    *   按ID范围获取块
    *   按时间范围获取块
*   Chaincode REST端点:在chaincode REST端点下，以下是服务列表:
    *   获取已安装链码的列表
    *   获取特定对等体上的链码列表
    *   获取频道上的链码列表
    *   安装链码
    *   实例化链代码
    *   Get chaincode info
*   统计REST端点:在统计REST端点下，以下是服务列表:
    *   当前存在的信道和每个信道上加入的对等体的列表
    *   指定对等方加入的当前数量和频道列表
    *   指定对等体上已安装的链码的当前数量和列表
    *   指定通道上实例化链码的当前数量
    *   为指定代理或所有代理配置的链码列表
    *   节点健康状态
    *   与节点使用相关的指标(CPU、内存、磁盘使用)
    *   异步调用的总数
    *   可计费交易的数量
    *   块数
    *   提交次数
    *   背书数量
    *   同步调用的总数
    *   对等方或渠道或整个网络的用户事务数量

有关这些服务的更多详细信息，请参考OBP文档。

# 摘要

本章主要讲述了尝试OBP解决方案的第一组步骤。我们已经介绍了转换OBP的网络拓扑、配置OBP网络基础设施、配置OBP交易基础设施、为OBP网络增加业务智能、REST代理配置以及管理REST接口。

下一章探索链码开发，比如语言部分、开发工具和开发环境设置。它还涵盖了chaincode从开发到更新的整个生命周期，包括安装、启动、测试和版本控制。它展示了一个完整的链代码，其代码库是用Go和Node.js构建的。它还说明了认可策略、私有数据收集、通过shim和REST端点进行的链代码测试，以及使用SDK、REST和events将客户端应用程序与业务网络集成。